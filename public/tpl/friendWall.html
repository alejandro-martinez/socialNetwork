<div id="header-info">
	<div id="profilePhoto" style="background-image:url('http://graph.facebook.com/<%= friend.id %>/picture?type=normal')"></div>
	<span><h1 id="name" class="speak" data-voice="<%= friend.name %>"><%= friend.name%></h2></span>
	<% if (!amigo) {%>
		<a href="/#friendAdd/<%= friend.id %>"><h1 class="icon-friend-add botonCircular bg-color-pinkDark speak" data-voice="Agregar a <%= friend.name%> a mis amigos"></h1></a>
	<%}%>	
	<a id="friendPhotos" href="/#friendPhotos/<%= friend.username %>"><h1 class="icon-photos botonCircular bg-color-pinkDark speak" data-voice="ver fotos de <%= friend.name%>"></h1></a>
	<a id="friendAlbums" href="/#albums/<%= friend.id %>"><h1 class="icon-albums botonCircular bg-color-green speak" data-voice="ver albums de <%= friend.name%>"></h1></a>
</div>
<div id="wall">
	<a class="prevPage friendWall" href="javascript:void(0)"></a>
	<a class="nextPage friendWall" href="javascript:void(0)"></a>
	<ul id="wall-template">
		<% _.each(wall, function(post) { %> 
		    <li>
		    	<div class="post">
				    <div class="avatar" style="background-image: url(http://graph.facebook.com/<%= post.attributes.from.id %>/picture?type=normal)">
					</div>
					<h1>
					<a class="speak" data-voice="Publicado por <%=post.attributes.from.name %>" href="/#friend/<%= post.attributes.from.id%>"><%= post.attributes.from.name%></a>
					<% if (post.attributes.to != null){%>
					>> <a class="speak" data-voice="para <%= post.attributes.to.data[0].name %>" href="/#friend/<%= post.attributes.to.data[0].id%>"><%= post.attributes.to.data[0].name %></a>
					<% }%>
				</h1> 
					<% if (post.attributes.story != null) { %>
						<div class="text speak" data-voice="<%=post.attributes.story%>"><%= post.attributes.story %></div>
					<% }%>

					<% if (post.attributes.message != null) { %>
						<div class="text speak" data-voice="<%=post.attributes.message%>"><%= post.attributes.message %></div>
					<% }%>

					<% if (post.attributes.source != null) { %>
						<iframe width="470" height="350" src="<%= post.attributes.source %>?autoplay=0" frameborder="0" allowfullscreen>
						</iframe>
					<% } else if (post.attributes.object_id != null) { %>
							<%var foto = post.attributes.picture;%>
							<img src="<%= foto.replace('s.jpg','n.jpg')%>" />
					<% } %>

					<% var postInfo = "A nadie le gusta esto";
						var likeText = "Me gusta";
						var likeClass="like"
					if (post.attributes.likes != null) {
						var likes = post.attributes.likes.data;
						var count = post.attributes.likes.data.length;
						if(count == 1){ 
							if(likes[0].id == miID){
								postInfo = "Te gusta esto!"
								likeText = "Ya no me gusta!"
								likeClass="unlike"
							}
							else{
								postInfo = "A " + likes[0].name + " le gusta esto!"
							}
						}
						else {
							if (count > 1) { 
								total = count - 1;
								if(likes[0].id == miID){
									postInfo = "A ti y a " + total + " personas les gusta esto"
									likeText = "Ya no me gusta!"
									likeClass="unlike"
								}
								else
									postInfo = "A " + likes[0].name + " y a " + total + " personas les gusta esto"
							}
						} 
					}%>
					<br>
					<a href="javascript:void(0)" class="postInfo speak" data-voice="<%=postInfo %>" name="infoLikes-<%=post.attributes.id%>"><%=postInfo %></a><br><br>

					<a href="javascript:void(0)" id="<%=post.attributes.id%>" class="<%=likeClass %> speak" data-voice="<%=likeText %>"><%=likeText %></a>
					<%if (post.attributes.likes != null) {
						var likes = post.attributes.likes.data;%>
						<div id="infoLikes-<%=post.attributes.id%>" class="hidden">
							<ul class="photo-comments">
								<% _.each(post.attributes.likes.data, function(autorLike) { %> 
										<div class="post">
								    		<div class="avatar" style="background-image: url(http://graph.facebook.com/<%=autorLike.id%>/picture?type=square)">
								    		</div>
								    		<h5><a href="/#friend/<%=autorLike.id%>" class="speak" data-voice="<%=autorLike.name%>"><%=autorLike.name%></a><h5>
								    	</div>	
								<% });%>    
					    	</ul>
						</div>	
					<%}%>	
					<ul id="comments-post-<%=post.id%>" class="hidden photo-comments">
							<%
							var totalComentarios=0;
							if (post.attributes.comments != null){
								totalComentarios = post.attributes.comments.data.length;
									_.each(post.attributes.comments.data, function(comment) { %> 
								<li>
							    	<div class="post">
							    		<div class="avatar" style="background-image: url(http://graph.facebook.com/<%=comment.from.id%>/picture?type=square)">
							    		</div>
							    		<h5><a href="/#friend/<%=comment.from.id%>" class="speak" data-voice="<%=comment.from.name%>"><%=comment.from.name%></a><h5>
							    		<span class="speak" data-voice="<%=comment.message%>"><%=comment.message%></span>
							    	</div>	
							    </li>	
								<%});%>
							<%}%>
							<div id="div-comment">
								<h3 class="speak" data-voice="Escribe un comentario">Escribe un comentario</h3>
								<textarea id="comentario" class="speak" data-voice="Qué estás pensando?"></textarea>
								<img src="http://png-1.findicons.com/files/icons/2015/24x24_free_application/24/error.png" class="hidden error"/>
								<img src="https://cdn2.iconfinder.com/data/icons/oxygen/48x48/actions/ok.png" class="hidden ok"/>
								<button id="publicarComentario" data-comment-id="<%=post.id%>" class="speak image-button bg-color-blue fg-color-white" data-voice="click para publicar comentario">Publicar</button>
							</div>	
						</ul>	
					<a href="javascript:void(0)" class="comments speak" data-voice="<%=totalComentarios%> Comentarios " name="comments-post-<%=post.id%>">Comentarios (<%=totalComentarios%>)</a>
				</div>
			</li>
		<% }); %>
	</ul>
</div>
